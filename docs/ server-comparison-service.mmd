sequenceDiagram
    actor User
    participant FE as Frontend
    participant Compare as Comparison API
    participant Cache as Redis
    participant PriceDB as Pricing Database
    participant AWS as AWS Pricing API
    participant Azure as Azure Pricing API
    participant GCP as GCP Pricing API

    Note over User, GCP: Price Data Sync (Daily)
    participant Sync as Sync Service
    Sync->>AWS: GET pricing data
    Sync->>Azure: GET pricing data
    Sync->>GCP: GET pricing data
    Sync->>PriceDB: Bulk INSERT/UPDATE
    
    Note over User, GCP: User Comparison Request
    User->>FE: Select specs (CPU:2, RAM:4GB)
    FE->>Compare: GET /api/compare?cpu=2&ram=4
    Compare->>Cache: Check cache key:2-4
    
    alt Cache Hit
        Cache-->>Compare: Cached results
    else Cache Miss
        Compare->>PriceDB: Query pricing WHERE cpu=2 AND ram=4
        PriceDB-->>Compare: Matching instances
        Compare->>Compare: Calculate best value
        Compare->>Cache: Store (TTL: 24h)
    end
    
    Compare-->>FE: 200 OK {providers, bestChoice}